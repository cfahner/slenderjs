"function"!=typeof Object.create&&(Object.create=function(){var f=function(){};return function(k){if(1<arguments.length)throw Error("Second argument not supported");if("object"!=typeof k)throw TypeError("Argument must be an object");f.prototype=k;var a=new f;f.prototype=null;return a}}());"object"!==typeof window.console&&(window.console={log:function(f){}});
(function(f,k){var a=f.jQuery,g=f.document;f.Slender={};var e=f.Slender;a(function(){a(".sl-nojs").remove();a(g).on("animationstart MSAnimationStart webkitAnimationStart oAnimationStart",".sl-nojs",function(b){"slNodeInserted"===b.originalEvent.animationName&&a(this).remove()})});var h={};e.subscribe=function(a,d,c){a in h||(h[a]=[]);h[a].push({subber:d,func:c})};e.unsubscribe=function(b,d){b in h&&h[b].length&&(h[b]=a.map(h[b],function(a){return a.func===d?k:a}))};e.publish=function(b,d,c){var l=
[];a.each(h[b]||[],function(f,e){a.isFunction(e.func)&&l.push(e.func.apply(e.subber,[c||{},d,b]))});return l};a(g).on("keyup focus","textarea",function(){clearTimeout(a(this).data("shrinkTimeout"));var b=a(this),d=a(f).scrollTop();b.css({height:0,"min-height":0,"max-height":0});var c=b[0].scrollHeight+parseFloat(b.css("border-top-width"))+parseFloat(b.css("border-bottom-width"));0===b[0].clientHeight&&(c+=parseFloat(b.css("padding-top"))+parseFloat(b.css("padding-bottom")));b.css({height:c+15,"min-height":"",
"max-height":""});a(f).scrollTop(d)});a(g).on("blur","textarea",function(){var b=this;a(this).data("shrinkTimeout",setTimeout(function(){a(b).css({height:"","min-height":"","max-height":""})},500))});var v=a("<button class='sl-flat sl-switch-enh'>").append(a("<span class=sl-switch-flip>"),a("<span class=sl-switch-space>"),a("<span class=sl-switch-text>")),r=function(a,d){var c=a.val(),l=d.data("valueOn"),e=d.data("valueOff"),f=e,g=d.data("labelOff"),h=d.find(".sl-switch-flip").removeClass("sl-switch-flip-on");
c===e&&(f=l,g=d.data("labelOn"),h.addClass("sl-switch-flip-on"));a.val(f);d.find(".sl-switch-text").text(g)},w=function(b){var d=v.clone().addClass(b.attr("class"));b.after(d).hide();var c=b.find(".sl-switch-on");0>=c.length&&(c=a(b.find("option")[0]));0>=c.length&&(c=a("<option value=1>").text("\u2713"));var e=b.find(".sl-switch-off");0>=e.length&&(e=a(b.find("option")[1]));0>=e.length&&(e=a("<option value=0>").text("\u00d7"));d.data({valueOn:c.val(),valueOff:e.val(),labelOn:c.text(),labelOff:e.text()}).click(function(){b.is(":enabled")&&
r(b,d)});for(c=0;2>c;c+=1)r(b,d)};a(function(){a(g).on("animationstart MSAnimationStart webkitAnimationStart oAnimationStart",".sl-switch",function(b){"slNodeInserted"===b.originalEvent.animationName&&w(a(b.target))})});var x=a("<div class=sl-tmid><div class='sl-ind sl-ind-load'></div></div>"),y=a("<div class=sl-tmid><div class='sl-ind sl-ind-error'></div></div>"),n,z=function(b,d){"object"!==typeof d&&(d={});m();n=a(f.document.activeElement);var c=a("<div class=sl-popbg>"),e=a("<div class=sl-popwrap>"),
g=a("<div class=sl-popcontain>").click(function(a){a.target===this&&m()}),h=a("<div class=sl-pop tabindex=0>"),k=a("<div>").html(x);d.styled&&h.addClass("sl-popstyled");h.append(k);a.ajax(b,{cache:!1,success:function(a){k.html(a)},error:function(){k.html(y)}});a("body").append(c);a("body").append(e.html(g.html(h)));setTimeout(function(){h.focus()},0);c.add(e)},m=function(){a("body").find(".sl-popwrap, .sl-popbg").remove();n&&n.focus()};a(g).on("click",".sl-popopen",function(b){var d=/^([0-9]*(\.[0-9]+)?){1}(em|px)?$/,
c=a(this).attr("data-screen-width");if(d.test(c)||"medium"===c||"large"===c)if("medium"===c?c="35em":"large"===c&&(c="65em"),c=d.exec(c),d=parseFloat(c[1]),c=c[3],"em"===c&&a(f).width()/parseFloat(a("body").css("font-size"))<d||"px"===c&&a(f).width()<d)return;b.preventDefault();z(a(this).attr("data-pophref")||a(this).attr("href")||"",{styled:"true"===a(this).attr("data-styled")})});a(g).on("click",".sl-popclose",function(a){a.preventDefault();m()});a(g).keydown(function(a){27===a.which&&m()});a(g).on("focus",
"input, select, textarea",function(){"string"!==typeof a(this).data("sl-last-confirm")&&a(this).data("sl-last-confirm",a(this).val())});a(g).on("change input paste keyup","input, select, textarea",function(){var b=a(this);clearTimeout(b.data("sl-current-timeout"));b.data("sl-current-timeout",setTimeout(function(){b.val()!=b.data("sl-last-confirm")&&(b.data("sl-last-confirm",b.val()),b.trigger("delaytextchange"))},500))});a.valHooks.text={set:function(b,d){a(b).data("sl-last-confirm",d)}};var t=function(){a(this).closest("form").submit()};
a(g).on("change",".sl-autosubmit",t).on("delaytextchange",".sl-autosubmit-delay",t);var u={},p=1,q={};e.View=function(){};e.View.prototype.enhance=function(a,d){this.viewId=a;this.element=d;this.onEnhance()};e.View.prototype.restore=function(){this.onRestore();delete this.viewId;delete this.element};e.defineView=function(a,d){u[a]=d};e.enhanceViews=function(b){a(b).find("[data-view]").each(function(){if(!a(this).data("SlenderViewId")){var b=a(this).attr("data-view"),c=u[b];if(c){b=p;p+=1;var f=Object.create(e.View.prototype),
g;for(g in c)f[g]=c[g];q[b]=f;a(this).data("SlenderViewId",b);f.enhance(b,a(this))}else console.log("undefined view: "+b)}})};e.restoreViews=function(b){a(b).find("[data-view]").each(function(){var b=a(this).data("SlenderViewId");b&&(q[b].restore(),delete q[b],a(this).removeData("SlenderViewId"))})};e.defineView("Slender.TestView",{onEnhance:function(){this.element.text("Enhanced")},onRestore:function(){this.element.text("Restored")}});a(function(){e.enhanceViews(a("body"))})})(window);
